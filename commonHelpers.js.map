{"version":3,"file":"commonHelpers.js","sources":["../src/js/messages-to-user.js","../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["const messages = {\n  endOfResults: \"We're sorry, but you've reached the end of search results.\",\n  noResults:\n    'Sorry, there are no images matching your search query. Please try again!',\n  emptyInput: 'Provide a search query...',\n};\n\nexport default messages;\n","import axios from 'axios';\nconst KEY = '43388201-d3d6dfd281aefcb5631baa551';\nimport messages from './messages-to-user';\n// axios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport default class apiRequest {\n  BASE_URL = 'https://pixabay.com/api/';\n  currentPage = 1;\n  resultsPerPage = 15;\n  totalPages = 0;\n  query = '';\n\n  async getImagesHits() {\n    const searchParams = {\n      params: {\n        key: KEY,\n        q: this.query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: this.currentPage,\n        per_page: this.resultsPerPage,\n      },\n    };\n    try {\n      const response = await axios.get(this.BASE_URL, searchParams);\n      this.totalPages = Math.ceil(\n        response.data.totalHits / this.resultsPerPage\n      );\n      if (response.data.hits.length === 0) {\n        throw new Error(messages.noResults);\n      }\n      return response.data.hits;\n    } catch (err) {\n      throw new Error(err.message);\n    }\n  }\n}\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport apiRequest from './pixabay-api';\nimport messages from './messages-to-user';\n\nconst api = new apiRequest();\n\nexport function createGalleryMarkup(imgs) {\n  return imgs\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"image-card\">\n          <a class=\"img-link\" href=${largeImageURL}>\n            <div class=\"gallery-image\">\n              <img class=\"image\" src=${webformatURL} alt=\"${tags}\">\n            </div>\n            <div class=\"img-caption\">\n                <ul class=\"img-stats\">\n                    <li class=\"stat-item\">\n                        <p class=\"stat-name\">Likes</p>\n                        <span>${likes}</span>\n                    </li>\n                    <li class=\"stat-item\">\n                        <p class=\"stat-name\">Views</p>\n                        <span>${views}</span>\n                    </li>\n                    <li class=\"stat-item\">\n                        <p class=\"stat-name\">Comments</p>\n                        <span>${comments}</span>\n                    </li>\n                    <li class=\"stat-item\">\n                        <p class=\"stat-name\">Downloads</p>\n                        <span>${downloads}</span>\n                    </li>\n                </ul>\n            </div>\n              </a>\n         </li>`\n    )\n    .join('');\n}\nfunction renderGallery(galleryRef, markup) {\n  const lightboxOptions = {\n    captions: true,\n    captionSelector: '.image',\n    captionType: 'attr',\n    captionsData: 'alt',\n    captionPosition: 'bottom',\n    captionDelay: 250,\n  };\n  const lightbox = new SimpleLightbox('.img-link', lightboxOptions);\n  galleryRef.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nexport async function getImgsGallery({ galleryRef, query, paginBtn, loader }) {\n  clearGallery(galleryRef);\n  api.query = query;\n  if (!query) {\n    throw new Error(messages.emptyInput);\n  }\n  changeVisibility(paginBtn, false);\n  try {\n    changeVisibility(loader, true);\n    const imgsHits = await api.getImagesHits();\n    changeVisibility(loader, false);\n    renderGallery(galleryRef, createGalleryMarkup(imgsHits));\n    changeVisibility(paginBtn, true) && api.totalPages > 1;\n  } catch (err) {\n    changeVisibility(paginBtn, false);\n    changeVisibility(loader, false);\n    renderMessages(err.message);\n  }\n}\n\nexport async function addImagesToGallery({ galleryRef, paginBtn, loader }) {\n  api.currentPage += 1;\n  changeVisibility(loader, true);\n  changeVisibility(paginBtn, false);\n  try {\n    const imgsHits = await api.getImagesHits();\n    changeVisibility(loader, false);\n    renderGallery(galleryRef, createGalleryMarkup(imgsHits));\n    changeVisibility(paginBtn, true) && api.currentPage < api.totalPages;\n    scroll(document.querySelector('.image-card'));\n    if (api.totalPages === api.currentPage) {\n      throw new Error(messages.endOfResults);\n    }\n  } catch (err) {\n    changeVisibility(paginBtn, false);\n    changeVisibility(loader, false);\n    renderMessages(err.message);\n  }\n}\n\nfunction scroll(imgCard) {\n  window.scrollBy({\n    top: imgCard.getBoundingClientRect().height * 2,\n    behavior: 'smooth',\n  });\n}\n\nexport function clearGallery(galleryRef) {\n  galleryRef.innerHTML = '';\n}\n\nexport function renderMessages(errorMessage) {\n  let options = {\n    message: errorMessage,\n    position: 'topRight',\n  };\n\n  switch (errorMessage) {\n    case messages.endOfResults:\n      options.progressBar = false;\n      options.transitionIn = 'fadeIn';\n      iziToast.info(options);\n      break;\n    case messages.emptyInput:\n      iziToast.warning(options);\n      break;\n    case messages.noResults:\n      iziToast.error(options);\n      break;\n    default:\n      iziToast.warning(options);\n  }\n}\n\nexport function changeVisibility(HTMLElement, visibility) {\n  visibility === false\n    ? HTMLElement.classList.add('hidden')\n    : HTMLElement.classList.remove('hidden');\n}\n","import {\n  getImgsGallery,\n  addImagesToGallery,\n  renderMessages,\n} from './js/render-functions';\n\nconst formRef = document.querySelector('.search-form');\nconst input = formRef['input'];\n// const mainContainerRef = document.querySelector('.container');\nconst galleryRef = document.querySelector('.gallery');\nconst paginBtn = document.querySelector('.js-load-more');\nconst loader = document.querySelector('.loader');\n\nformRef.addEventListener('submit', handleSearchSubmit);\n\npaginBtn.addEventListener('click', handleLoadMore);\nconst options = { galleryRef, query: '', paginBtn, loader };\n\nasync function handleSearchSubmit(e) {\n  e.preventDefault();\n  try {\n    options.query = input.value.trim().toLowerCase();\n    await getImgsGallery(options);\n  } catch (err) {\n    renderMessages(err.message);\n    console.log(err);\n  }\n}\n\nasync function handleLoadMore(e) {\n  e.preventDefault();\n  try {\n    await addImagesToGallery(options);\n  } catch (err) {\n    renderMessages(err.message);\n    console.log(err);\n  }\n}\n"],"names":["messages","KEY","apiRequest","__publicField","searchParams","response","axios","err","api","createGalleryMarkup","imgs","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderGallery","galleryRef","markup","lightboxOptions","lightbox","SimpleLightbox","getImgsGallery","query","paginBtn","loader","clearGallery","changeVisibility","imgsHits","renderMessages","addImagesToGallery","scroll","imgCard","errorMessage","options","iziToast","HTMLElement","visibility","formRef","input","handleSearchSubmit","handleLoadMore","e"],"mappings":"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"}