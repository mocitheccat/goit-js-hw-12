{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport { renderErrorMessages } from './render-functions';\nconst KEY = '43388201-d3d6dfd281aefcb5631baa551';\n\nconst searchParams = new URLSearchParams({\n  key: KEY,\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  page: 1,\n  per_page: 200,\n});\n\nexport default async function getImages(query, page = 1) {\n  searchParams.set('q', query);\n  searchParams.set('page', page);\n\n  try {\n    const response = await axios.get(\n      `https://pixabay.com/api/?${searchParams.toString()}`\n    );\n    if (response.data.hits.length === 0) {\n      renderErrorMessages(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n    }\n    console.log(response.data);\n    return response.data;\n  } catch (err) {\n    console.log(err);\n    renderErrorMessages(err.message);\n  }\n}\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport getImages from './pixabay-api';\n\nexport function createGalleryMarkup(imgs) {\n  return imgs\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"image-card\">\n          <a class=\"img-link\" href=${largeImageURL}>\n            <div class=\"gallery-image\">\n              <img class=\"image\" src=${webformatURL} alt=\"${tags}\">\n            </div>\n            <div class=\"img-caption\">\n                <ul class=\"img-stats\">\n                    <li class=\"stat-item\">\n                        <p class=\"stat-name\">Likes</p>\n                        <span>${likes}</span>\n                    </li>\n                    <li class=\"stat-item\">\n                        <p class=\"stat-name\">Views</p>\n                        <span>${views}</span>\n                    </li>\n                    <li class=\"stat-item\">\n                        <p class=\"stat-name\">Comments</p>\n                        <span>${comments}</span>\n                    </li>\n                    <li class=\"stat-item\">\n                        <p class=\"stat-name\">Downloads</p>\n                        <span>${downloads}</span>\n                    </li>\n                </ul>\n            </div>\n              </a>\n         </li>`\n    )\n    .join('');\n}\n\nexport function renderGallery(response, containerRef, galleryRef, markup) {\n  console.dir(containerRef);\n  toggleLoader();\n  galleryRef.insertAdjacentHTML('beforeend', markup);\n\n  const lightboxOptions = {\n    captions: true,\n    captionSelector: '.image',\n    captionType: 'attr',\n    captionsData: 'alt',\n    captionPosition: 'bottom',\n    captionDelay: 250,\n  };\n\n  const imgsCard = containerRef.querySelectorAll('.image-card');\n  console.log(imgsCard.length);\n  if (imgsCard.length < response.totalHits) {\n    containerRef.lastElementChild.removeAttribute('hidden');\n  } else {\n    containerRef.lastElementChild.setAttribute('hidden', '');\n  }\n  const lightbox = new SimpleLightbox('.img-link', lightboxOptions);\n  lightbox.refresh();\n}\n\nexport function clearGallery(galleryRef) {\n  galleryRef.innerHTML = '';\n}\n\nexport function renderErrorMessages(errorMessage) {\n  iziToast.error({\n    message: errorMessage,\n    position: 'topRight',\n  });\n}\n\nexport function toggleLoader() {\n  const loader = document.querySelector('.loader');\n  loader.classList.toggle('disabled');\n}\n","import {\n  toggleLoader,\n  renderGallery,\n  createGalleryMarkup,\n  renderErrorMessages,\n  clearGallery,\n} from './js/render-functions';\n\nimport getImages from './js/pixabay-api';\n\nconst formRef = document.querySelector('.search-form');\nconst input = formRef['input'];\nconst mainContainerRef = document.querySelector('.container');\nconst galleryRef = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.js-load-more');\n\nasync function handleSearchSubmit(e) {\n  e.preventDefault();\n\n  const query = input.value.trim().toLowerCase();\n\n  if (!query) {\n    renderErrorMessages('Please enter a search query.');\n    return;\n  }\n\n  clearGallery(galleryRef);\n  toggleLoader();\n\n  const response = await getImages(query);\n  renderGallery(\n    response,\n    mainContainerRef,\n    galleryRef,\n    createGalleryMarkup(response.hits)\n  );\n\n  loadMoreBtn.addEventListener('click', handleLoadMoreClick.bind(null, query));\n}\n\nasync function handleLoadMoreClick(query, e) {\n  e.preventDefault();\n  toggleLoader();\n  loadMoreBtn.setAttribute('hidden', '');\n  let page = parseInt(loadMoreBtn.dataset.page) || 2;\n  const response = await getImages(query, page);\n  renderGallery(\n    response,\n    mainContainerRef,\n    galleryRef,\n    createGalleryMarkup(response.hits)\n  );\n  loadMoreBtn.removeAttribute('hidden');\n  page += 1;\n  loadMoreBtn.dataset.page = page;\n}\n\nformRef.addEventListener('submit', handleSearchSubmit);\n"],"names":["KEY","searchParams","getImages","query","page","response","axios","renderErrorMessages","err","createGalleryMarkup","imgs","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderGallery","containerRef","galleryRef","markup","toggleLoader","lightboxOptions","imgsCard","SimpleLightbox","clearGallery","errorMessage","iziToast","formRef","input","mainContainerRef","loadMoreBtn","handleSearchSubmit","e","handleLoadMoreClick"],"mappings":"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"}